## 数维杯论文



### 摘要

采用固定翼与旋翼相结合的复合直升机设计能够保持直升机灵活飞行的能力，同时提升其高速飞行能力。通过操作同轴直升机四个动力构件，我们能在保证直升机飞行机动的同时控制其姿态角保持良好状态。通过建立直升机飞行的物理和数学模型，对直升机姿态进行预测和操控，对直升机设计及使用具有重要意义。

针对问题一和问题二，我们首先建立了问题分析的**欧拉角模型**（以及直升机**局域坐标系**的概念）为问题分析提供了框架。为了求解**力矩系数**的表达式（给定条件下的力矩系数），我们拟合了（对...进行了插值）moment factor functions和functions of propeller thruster thrust and rotational torque，并建立了**空气动力学模型**和简化的**流量守恒模型**求解动压，建立了与七个操纵量以及飞机飞行速度相关的**力矩表达式**。通过确定**惯量主轴**，我们确定了力矩与直升机姿态角的动力学关系（确认了力矩与局域坐标系下角度变化的关系），计算得到了姿态角随时间变化的关系。

针对问题三和问题四，我们分析直升机满足的**动力学条件**，按照流量守恒模型的一般情形和简化的特殊情况得到了操纵量分别满足的的方程。问题三中，所限制条件不随时间变化而改变，所解得的操纵量解空间也不随时间改变。特别的，在简化的特殊情况中，固定垂直尾翼和水平尾翼与气流之间所成角度为0角度，设计了只调节同轴旋翼4个操纵量的操作方案。问题四中，随着时间变化，动压也随之发生改变，所解得的解空间也随时间改变而改变。在简化的特殊情况中，我们始终保持垂直尾翼和水平尾翼与气流之间所成角度为0角度，设计了只调节同轴旋翼4个操纵量的操作方案。此外我们分别对两题作**灵敏度分析**，找出了最稳定也即最易操作的方案。

### 问题背景

直升机具备垂直起飞降落等飞行能力，因而广泛应用与侦察和运输等领域。然而，传统直升机的构造使其在高速飞行时旋翼叶片易受到冲击影响，难以稳定飞行。为了在保持直升机灵活飞行能力的同时提升其高速飞行能力，采用固定翼与旋翼相结合的复合直升机设计，已成为重要的发展方向。在此背景下，本文对同轴直升机在低速和高速模式下，姿态角的变化模型和不同飞行任务中相关控制组件的最优组合进行相关研究。

### 问题分析

#### 基本概念分析

同轴直升机是一种典型的复合直升机类型，其构造主要由四个动力组件组成：**同轴刚性旋翼**、**螺旋桨推进器**、**水平尾翼**、**垂直尾翼**。

其中，同轴刚性旋翼是指两个或多个旋翼位于相同轴线上，且共享同一旋翼中心的系统，其可以提供更好的稳定性和控制性能，减少扭矩效应； 螺旋桨推进器是一种通过螺旋桨产生推力的机制，为直升机提供推力；水平尾翼是直升机尾部的一个水平的翼面，其助于维持直升机的平衡和稳定性；垂直尾翼是直升机尾部的一个垂直的翼面，其有助于维持直升机的方向稳定性。

直升机的飞行姿态使用姿态角来描述，分别是飞行中的**滚转角ϕ、俯仰角θ、偏航角ψ**，其分别指直升机在飞行过程中绕其前进方向（即纵轴）旋转的角度、绕其横轴旋转的角度、绕其垂直轴旋转的角度。

飞行过程中姿态角的变化主要由其对应的力矩决定，其分别为**滚转力矩、俯仰力矩、偏航力矩**，这三个力矩分别产生相应角度上的运动。

#### 力学分析

同轴直升机的四个动力组件带来了七个可操作部分，其分别为：

（1）同轴旋翼包含两个同轴反转的旋翼以尽可能抵消旋翼施加的扭矩。同时两个旋翼有一定的运动自由度，存在四个操作，总体上会带来旋翼滚转力矩、旋翼俯仰力矩、旋翼偏航力矩，体现为旋翼滚转力矩系数、旋翼俯仰力矩系数、旋翼偏航力矩系数。通过力矩系数可以得到力矩因子，从而进一步得到对应的力矩。其四个操作分别为：

- *总距离*$u_c$
- 差分总距离$u_{cd}$
- 纵向循环俯仰$u_e$
- 横向循环俯仰$u_a$

（2）螺旋桨推进器操作容量$u_t$。其代表了推进器工作的功率，其与推进器提供的力和力矩有确定的正相关关系，这一扭矩也就是螺旋桨推进器导致的滚转力矩。同时，直升机的推进力主要来自于螺旋桨推进器。

（3）升降舵偏转值$u_{eh}$：代表水平尾翼上下俯仰的角度，会产生俯仰力矩。

（4）方向舵偏转值$u_{av}$：代表垂直尾翼左右偏转的角度，会产生偏航力矩。

#### 问题一二分析

前两题要求求解给定条件下滚转、俯仰和偏航力矩表达式，基于此建立俯仰角变化模型，并给出飞机5秒、10秒和20秒时时的姿态角。三种力矩的物理原理已知，只需要拟合出rotor moment factor 以及horizontal and vertical tail moment factor的13个函数关系，就可以得到给定速度下的力矩系数，建立姿态角运动方程并求解出姿态角随时间变化的函数。前两问中给定了不同的垂直速度分量，要求求解的姿态角分别是一个和三个。为了完整考虑垂直方向的速度分量影响，我们建立了基于流体力学的动压求解公式，并简化为尾翼角度带来的气流速度增大。在此基础上我们得到了相应的微分方程组，并编写python程序求解微分方程组，得到了前两问的答案。

#### 问题三四分析

后两题要求设计组件机动幅度满足直升机在一定速度变化下的零姿态角飞行。第三题限制直升机匀速直线运动，要求设计组件的机动幅度以使机身姿态保持为零姿态角。由于飞机状态保持不变，只需使姿态角运动方程中三种力矩均取为零即可在运动过程全程实现零姿态角。第四题限制飞机以给定加速度运动，在机身上引入了螺旋桨推进器的恒定扭矩，并且由于空气速度的变化使动压发生变化，必须输入动态的组件机动幅度以满足题设要求，力矩为零的方程变为含有参数t的动态方程。然而在这两题中，可操作的参数多于相应的限制，这将带来不同的直升机操作方案。我们通过考察灵敏度最低、也即最稳定的操作参数获得最佳方案。

### 数据分析与符号说明



（加表头（表头名称待定） 不要中文 只要英文 英文列名称为“名称”）



| 英文 | 中文             | 符号 | 量纲  | 数值  |
| ---- | ---------------- | ---- | ----- | ----- |
| Mass | 直升机质量       | M    | kg    | 5000  |
|      | 直升机总长       | L    | m     | 8     |
|      | 滚转转动惯量     | I_1  |       | 8000  |
|      | 俯仰转动惯量     | I_2  |       | 20000 |
|      | 偏航转动惯量     | I_3  |       | 25000 |
|      | 旋翼半径         | R_1  | m     | 6     |
|      | 旋翼速度         | V_1  |       | 180   |
|      | 螺旋桨横行距离   | L_2  | m     | -3.5  |
|      | 螺旋桨纵向距离   | H_2  | m     | -0.2  |
|      | 水平尾翼面积     | S_3  | $m^2$ | 1     |
|      | 水平尾翼横向距离 | L_3  | m     | -3    |
|      | 垂直尾翼面积     | S_4  | $m^2$ | 0.5   |
|      | 垂直尾翼横向距离 | L_4  | m     | -3    |
|      | 垂直尾翼纵向距离 | H_4  | m     | 0.2   |



| 英文 | 中文                       | 符号 | 量纲 | 范围     |
| ---- | -------------------------- | ---- | ---- | -------- |
|      | 同轴旋翼总距离             | u_c  |      | [0,30]   |
|      | 差分总距离                 | u_cd |      | [-25,25] |
|      | 纵向循环俯仰               | u_e  |      | [-25,25] |
|      | 横向循环俯仰               | u_a  |      | [-25,25] |
|      | 推进螺旋桨推进能力         | u_t  |      | [0,36]   |
|      | 升降舵偏转值               | u_eh |      | [-25,25] |
|      | 方向舵偏转值               | u_av |      | [-25,25] |
|      | 推进螺旋桨推进能力对应力   | F_p  |      |          |
|      | 推进螺旋桨推进能力对应力矩 | M_r2 |      |          |



|                                              |      |           |           | R=F/R     |           |           |
| :------------------------------------------- | :--- | :-------- | :-------- | :-------- | :-------- | :-------- |
| 英文                                         | 符号 | 0         | 0.1       | 0.2       | 0.3       | 80/180    |
| Roll deflection value                        | R_1  | 0.0002    | 0.00035   | 0.0004    | 0.0004    | 0.000413  |
| Lateral pitch roll factor                    | R_2  | 0.00028   | 0.00032   | 0.0004    | 0.00044   | 0.00052   |
| Differential total distance roll coefficient | R_3  | -0.00005  | -0.00019  | -0.00024  | -0.00025  | -0.000295 |
| Pitch deviation value                        | R_4  | 0.001     | 0.0014    | 0.0029    | 0.0042    | 0.0059    |
| Longitudinal variable pitch coefficient      | R_5  | 0.0002    | 0.00038   | 0.00045   | 0.0005    | 0.0007193 |
| Total pitch coefficient                      | R_6  | -0.00002  | 0.00017   | 0.00034   | 0.00043   | 0.00055   |
| Differential total pitch coefficient         | R_7  | 0.0001    | 0.00005   | -0.000001 | -0.000001 | -0.000001 |
| Yaw deviation value                          | R_8  | 0.0003    | 0.0002    | 0.0001    | 0.0001    | 0.0001    |
| Differential total pitch yaw coefficient     | R_9  | 0.00009   | 0.00011   | 0.00008   | 0.00008   | 0.00008   |
| Horizontal tail moment coefficient deviation | R_10 | -0.0001   | -0.0001   | -0.0001   | -0.0001   | -0.0001   |
| Elevator coefficient                         | R_11 | -0.000001 | -0.00001  | -0.00005  | -0.00013  | -0.00019  |
| Vertical tail moment coefficient deviation   | R_12 | -0.00001  | -0.0001   | -0.00015  | -0.0002   | -0.00027  |
| Rudder coefficient                           | R_13 | -0.000001 | -0.000005 | -0.000016 | -0.000028 | -0.000046 |



（此表格补全数据）

| 英文                                 | 中文     | 符号 | 量纲 |
| ------------------------------------ | -------- | ---- | ---- |
| Propeller thruster thrust            | 推力     | F_p  |      |
| Propeller thruster rotational torque | 推力扭矩 | M_r2 |      |



### 模型假设



1. 假设给定的三个转动惯量是惯量主轴上的转动惯量，因此相对于直升机自身瞬时局域参考系的转动相互之间是独立的
2. 认为流体为不可压缩流体，符合伯努利原理
3. 尾翼表面空气流有与空气环境速度相同方向上有与其相同的分量，并满足速度场平行于机翼表面
4. 不考虑两个尾翼以及机身其他部分之间相互影响气流场
5. 空气密度为定值，海拔变化导致的空气密度变化被忽略
6. 不考虑姿态角导致旋翼产生的其他方向的力，认为竖直方向始终能保持匀速运动，前进方向只有螺旋桨推进器的推力作用在机身上

### 模型的建立与求解



#### 问题一与问题二模型的建立和求解

##### 直升机姿态角的欧拉角模型

为了更为精确地描述直升机地飞行姿势，并基于此进行后续直升机运动状态的描述，我们基于题中给出的滚转角、俯仰角和偏航角建立了直升机姿态角的欧拉角模型。

欧拉角模型基于笛卡尔坐标系，用于表示三维坐标系中的方向和方向变换，其通过在三维空间指定与三个旋转轴相关联的三个角度来最小参数化$SO(3)$以表示任意方向。

首先，我们建立以直升机质心为原点的平动参考系XYZ：
$$
\left(\begin{array}{l}
X \\
Y \\
Z
\end{array}\right)=\left(\begin{array}{l}
x+\Delta x \\
y+\Delta y \\
z+\Delta z
\end{array}\right)
$$
其中$\Delta x,\Delta y,\Delta z$分别表示直升机在三个方向上的平动距离，xyz坐标系为起始点处静止坐标系，以此建立新的平动坐标系XYZ。

此外我们建立了固着在直升机上，随着其姿态变化而改变的区域参考系$XYZ^*$：

我们使用欧拉角来描述飞行器的姿态，其通常包括滚转（Roll）、俯仰（Pitch）和偏航（Yaw）三个角度。这三个角度分别描述了飞行器绕其自身三个轴旋转的情况。这三个角度可以组合形成欧拉角序列，根据旋转顺序的不同，可以有不同的表示方法。并此处我们考虑Z-Y-X顺序，即航向-俯仰-滚转（Heading-Pitch-Roll，HPR）顺序，对于直升机的飞行，这些角度可以用来描述飞行器相对于水平轴、纵轴和垂直轴的姿势。

1. **滚转（Roll）角（φ）：** 绕飞行器的纵轴X*轴旋转的角度。
2. **俯仰（Pitch）角（θ）：** 绕飞行器的横轴Y*轴旋转的角度。
3. **偏航（Yaw）角（ψ）：** 绕飞行器的垂直轴Z*轴旋转的角度。

我们可以使用这些角度度量两个坐标系之间的关系：
$$
\left(\begin{array}{l}
X \\
Y\\
Z
\end{array}\right)^*=M_2(\psi, \theta, \phi)\left(\begin{array}{l}
X \\
Y \\
Z
\end{array}\right)
$$
其中$M_2$为旋转矩阵，用于描述直升机运动过程中从XYZ参考系到$(X,Y,Z)^*$系的姿态变化。其中旋转矩阵：
$$
M_2(\psi, \theta, \phi)=R_z(\psi) R_y(\theta) R_x(\phi)
$$
其中$R_z(\psi) $， $ R_y(\theta)$和$ R_x(\phi)$分别是绕$Z^*$轴、$Y^*$轴和$X^*$轴旋转相应角度的旋转矩阵。

绕X轴的旋转矩阵 $R_x(\phi)$ :
$$
R_x(\phi)=\left[\begin{array}{ccc}
1 & 0 & 0 \\
0 & \cos (\phi) & -\sin (\phi) \\
0 & \sin (\phi) & \cos (\phi)
\end{array}\right]
$$
绕Y轴的施转矩阵 $R_y(\theta)$ :
$$
R_y(\theta)=\left[\begin{array}{ccc}
\cos (\theta) & 0 & \sin (\theta) \\
0 & 1 & 0 \\
-\sin (\theta) & 0 & \cos (\theta)
\end{array}\right]
$$
绕Z轴的施转矩阵 $\R_z(\psi)$ :
$$
R_z(\psi)=\left[\begin{array}{ccc}
\cos (\psi) & -\sin (\psi) & 0 \\
\sin (\psi) & \cos (\psi) & 0 \\
0 & 0 & 1
\end{array}\right]
$$

实际上，$M_2$是任何两个能以Z-Y-X顺序和$(\psi,\theta,\phi)$的欧拉角序列旋转重合的坐标系之间的旋转矩阵。

##### 问题一给出的解题数据（还有问题二）

（符号和英文两列合并，后面的参照第四行写，相应的英文看原文，另外最好把飞机上的几个纵横距离改成小写）

| 英文                                 | 符号     | 数据              |
| ------------------------------------ | -------- | ----------------- |
| initial flight altitude $H$          |          | 3000              |
| flight speed forward component$v_f$  |          | 80                |
| vertical ascent component $v_v$      |          | 2                 |
| Coaxial rotor overall distance $u_c$ |          | 0                 |
|                                      | $u_{cd}$ | -2.1552           |
|                                      | $u_e$    | -3.4817           |
|                                      | $u_a$    | -2.0743           |
|                                      | $u_t$    | 0                 |
|                                      | $u_{eh}$ | -9.0772*$10^{-7}$ |
|                                      | $u_{av}$ | 4.1869*$10^{-7}$  |



##### Moment factor functions 回归

对于附件中给出的相关参数数据，我们考虑基于原始数据对相关参数进行数值回归，并依据于数据的丰富程度和使用范围，分别选择最为合适的回归方法。



对于附件给出的Roll deflection value至Rudder coefficient在Flight Speed / Rotor Blade Tip Speed为0、0.1、0.2、0.3时对应的值，我们考虑其数据量较少，并且题中给出的数据Flight Speed / Rotor Blade Tip Speed为80/180,我们采用python程序对13份数据进行了插值回归，分别得到了其在80/180时对于的数据，具体如下：

|                                              |      | R=F/R     |
| -------------------------------------------- | ---- | --------- |
| 英文                                         | 符号 | 80/180    |
| Roll deflection value                        | R_1  | 0.000413  |
| Lateral pitch roll factor                    | R_2  | 0.00052   |
| Differential total distance roll coefficient | R_3  | -0.000295 |
| Pitch deviation value                        | R_4  | 0.0059    |
| Longitudinal variable pitch coefficient      | R_5  | 0.0007193 |
| Total pitch coefficient                      | R_6  | 0.00055   |
| Differential total pitch coefficient         | R_7  | -0.000001 |
| Yaw deviation value                          | R_8  | 0.0001    |
| Differential total pitch yaw coefficient     | R_9  | 0.00008   |
| Horizontal tail moment coefficient deviation | R_10 | -0.0001   |
| Elevator coefficient                         | R_11 | -0.00019  |
| Vertical tail moment coefficient deviation   | R_12 | -0.00027  |
| Rudder coefficient                           | R_13 | -0.000046 |





对于题中给出的Propeller thruster operating capacity（即$u_t$)与Propeller thruster thrust和Propeller thruster rotational torque之间的数据关系，考虑其数据量较为丰富，并且仅在给定范围内寻找参数值，我们选择对其进行多项式回归，以便得到范围内其它$u_t$数值对应的F_p与M_r2：

| 英文                                 |      | 符号 |      | 回归关系                                                   |
| ------------------------------------ | ---- | ---- | ---- | ---------------------------------------------------------- |
| Propeller thruster thrust            |      | F_p  |      | 30.051${u_t}^3$ - 295.35${u_t}^2$ + 1581.7${u_t}$ - 1128.6 |
| Propeller thruster rotational torque |      | M_r2 |      | 20.96${u_t}^3$ - 211.26${u_t}^2$ + 1041.6${u_t}$ - 678.57  |



##### 力矩系数

利用初始数据分别计算，其公式为：
$$
\\C_{r_1}=R_1+R_2\times u_a+R_3\times u_{cd}
\\C_{p_1}=R_4 +R_5\times u_e+R_6\times u_c+R_7\times u_{cd}
\\C_{y_1}=R_8 + R_9\times u_{cd}
\\C_{p_3}=R_{10}+R_{11}\times u_{eh}
\\C_{ry_4}=R_{12}+R_{13}\times u_{av}
$$
其中

$C_{r1}$为旋翼滚转力矩系数= 滚转偏转值 + 横向俯仰滚转系数 × 横向循环俯仰 + 差分总距离滚转系数 × 差分总距离

$C_{p1}$为旋翼俯仰力矩系数= 俯仰偏转值 + 纵向可变俯仰系数 × 纵向循环俯仰 + 总俯仰系数 × 总距离 + 差分总俯仰系数 × 差分总距离

$C_{y1}$为旋翼偏航力矩系数= 偏航偏差 + 差分总俯仰偏航系数 × 差分总距离

$C_{p3}$为水平尾翼俯仰力矩系数=（参考附件第五页英文补全，复制粘贴）

$C_{ry4}$为垂直尾翼俯仰/偏航力矩系数=（同上）（此处翻译时直接按照符号表补全）



##### 力矩表达式

基于上述力矩系数，我们得到下面的力矩表达式

旋翼滚转力矩$M_{r_1}=\frac{1}{2}C_{r_1}\rho S_1V_1^2$

旋翼俯仰力矩$M_{p_1}=\frac{1}{2}C_{p_1}\rho S_1V_1^2$

旋翼偏航力矩$M_{y_1}=\frac{1}{2}C_{y_1}\rho S_1V_1^2$

螺旋桨推进器扭矩（滚转力矩）$M_{r_2}$ 

水平尾翼俯仰力矩$M_{p_3}=\frac{1}{2}l_3C_{p_3}\rho \oint_{S_3}\vec{v}^2(\vec x)\,\textrm{d}S$

垂直尾翼滚转力矩$M_{r_4}=\frac{1}{2}h_4C_{ry_4}\rho\oint_{S_4}\vec{v}^2(\vec x)\,\textrm{d}S$

垂直尾翼偏航力矩$M_{y_4}=\frac{1}{2}l_4C_{ry_4}\rho\oint_{S_4}\vec{v}^2(\vec x)\,\textrm{d}S$

于是我们可以得到总的滚转力矩、俯仰力矩、偏航力矩的表达式：
$$
M_r=M_{r_1}+M_{r_2}+M_{r_4}=\frac{1}{2}C_{r_1}\rho S_1V_1^2+M_{r_2}+\frac{1}{2}h_4C_{ry_4}\rho\oint_{S_4}\vec{v}^2(\vec x)\,\textrm{d}S
\\M_p=M_{p_1}+M_{p_3}=\frac{1}{2}C_{p_1}\rho S_1V_1^2+\frac{1}{2}l_3C_{p_3}\rho \oint_{S_3}\vec{v}^2(\vec x)\,\textrm{d}S
\\M_y=M_{y_1}+M_{y_4}=\frac{1}{2}C_{y_1}\rho S_1V_1^2+\frac{1}{2}l_4C_{ry_4}\rho\oint_{S_4}\vec{v}^2(\vec x)\,\textrm{d}S
$$
然而，在实际情形中，尾翼与气流成不同角度时，尾翼表面气流实际流速不同，导致动压力$\frac{1}{2}\rho\oint_{S}\vec{v}^2(\vec x)\,\textrm{d}S$不同，下面建立速度场求解模型。

##### 速度场的求解

假设空气为不可压缩流体，满足伯努利方程，压强场$p(\vec x)$求解方程如下。
$$
\nabla\cdot \vec J(\vec x)=0
\\\vec J(\vec x)=\vec V(\vec x)\cdot \rho
\\p(\vec x)+\frac{1}{2}\rho{\vec V(\vec x)}^2=C
$$

其中$\vec J(\vec x)$为空气质量流场，$\vec V(\vec x)$为空气速度场，$p(\vec x)$为压强场，$\rho$为空气密度。满足以下条件：
$$
\lim_{\vec x\to\infin}\vec J(\vec x)=\rho\vec V_0
\\\lim_{\vec x\to\infin}p(\vec x)=p_0
\\F_{H-tail}(\vec x)=0 时,\,有\vec J(\vec x)\cdot\left(M_2(\psi, \theta, \phi)
\left(\begin{array}{l}
\quad1\\
\quad0\\
\tan{u_{eh}} 
\end{array}\right)\right)
=0
\\F_{V-tail}(\vec x)=0 时,\,有\vec J(\vec x)\cdot\left(M_2(\psi, \theta, \phi)
\left(\begin{array}{l}
-\tan{u_{av}} \\
\qquad1 \\
\qquad0
\end{array}\right)\right)=0
$$

其中$\vec J(\vec x)$为空气质量流场，$\vec V(\vec x)$为空气速度场，$p(\vec x)$为压强场，$\rho$为空气密度，$\vec{V}_0=(-80,0,2)$为气体环境速度，$F_{H-tail}=0$是水平尾翼的几何外形满足的方程，$F_{V-tail}=0$是垂直尾翼的几何外形满足的方程。

以上方程不易求解，我们使用**简化的流量守恒模型**求解速度场。考虑尾翼迎风侧表面，我们假设在迎风侧表面的气流速度由两部分分量组成，其中一个分量$\vec{v}_1(x)$等于气流环境的速度，与之垂直的$\vec{v}_2(x)$使得和速度仍分别满足上述尾翼表面方程（a）或（b）（最后两式）。这样气流流管变窄，气体以更快的速度流过表面，与空气环境气流速度相比，保证了相同时间内有等量的气体流过。由尾翼表面方程和气体环境速度我们可以得到两个尾翼的表面空气速度表达式：
$$
\vec{v}_H=\vec{v}_{H1}+\vec{v}_{H2}=g_0(\phi,\theta,\psi)
\\\vec{v}_V=\vec{v}_{V1}+\vec{v}_{V2}=g_1(\phi,\theta,\psi)
$$

也即
$$
v_H=\sqrt{80^2+2^2}/\left((0,0,1)M_2(\phi,\theta,\psi)\left(\begin{array}{l}
0 \\
0 \\
1
\end{array}\right)\right)\\
v_V=\sqrt{80^2+2^2}/\left((0,1,0)M_2(\phi,\theta,\psi)\left(\begin{array}{l}
0 \\
1 \\
0
\end{array}\right)\right)
$$

##### 第一问求解

在使用惯量主轴情形下，力矩与角度的一般关系为：
$$
M_w=I_w\times \frac{d^2\theta_w}{dt^2}
$$
其中$M_w$为某方向的力矩，$I_w$为相应轴上的转动惯量，$\theta_w$为对应该轴的角度。于是我们可以得到以下方程：
$$
\frac{1}{2}C_{r_1}\rho S_1V_1^2+f(u_t)+\frac{1}{2}h_4C_{ry_4}\rho\oint_{S_4}\vec{v}^2(\vec x)\,\textrm{d}S=I_r\ddot\phi_d
\\\frac{1}{2}C_{p_1}\rho S_1V_1^2+\frac{1}{2}l_3C_{p_3}\rho \oint_{S_3}\vec{v}^2(\vec x)\,\textrm{d}S=I_p\ddot\theta_d
\\\frac{1}{2}C_{y_1}\rho S_1V_1^2+\frac{1}{2}l_4C_{ry_4}\rho\oint_{S_4}\vec{v}^2(\vec x)\,\textrm{d}S=I_y\ddot\psi_d
$$
其中$v$取所计算的定值，$\phi_d,\theta_d,\psi_d$分别表示相对于瞬时静止坐标系的角度，其满足：
$$
M_2(\phi+d\phi,\theta+d\theta,\psi+d\psi)\left(\begin{array}{l}
X \\
Y \\
Z
\end{array}\right)=M_2(d\phi_d,d\theta_d,d\psi_d)\left(\begin{array}{l}
X \\
Y \\
Z
\end{array}\right)^*
\\\left(\begin{array}{l}
X \\
Y \\
Z\end{array}\right)^*=M_2(\phi,\theta,\psi)\left(\begin{array}{l}
X \\
Y \\
Z
\end{array}\right)
$$
也即
$$
M_2(d\phi_d,d\theta_d,d\psi_d)=M_2(\phi+d\phi,\theta+d\theta,\psi+d\psi)M_2^{-1}(\phi,\theta,\psi)
$$
由上式可以得到$(d\phi_d,d\theta_d,d\psi_d)$与$(d\phi,d\theta,d\psi)$的变换关系。联立以上方程可以得到关于$(\phi,\theta,\psi)$的微分方程，编写程序进行离散化求解可以得到任意时刻$(\phi,\theta,\psi)$的值。在第一问中，我们忽略较小的$M_p$和$M_y$，解得：
$$
\theta(5)=1.9119degree\,,\theta(10)=3.8162degree\,,\theta(20)=7.6399degree
$$

##### 第二问求解

同问题一的求解类似，空气环境速度变为$\vec{V}_0=(-80,0,0.2)$，同样可以求得：
$$
v_H=\sqrt{80^2+0.2^2}/\left((0,0,1)M_2(\psi,\theta,\phi)\left(\begin{array}{l}
0 \\
0 \\
1
\end{array}\right)\right)\\
v_V=\sqrt{80^2+0.2^2}/\left((0,1,0)M_2(\psi,\theta,\phi)\left(\begin{array}{l}
0 \\
1 \\
0
\end{array}\right)\right)
$$
解上述方程组同样可以得到姿态角随时间的变化趋势$\left(\phi(t),\theta(t),\psi(t)\right)$，相应的预测值为：
$$
\phi(5)=0.2063degree\,,\phi(10)=0.4139degree\,,\phi(20)=0.8377degree\,
\\\theta(5)=0.3103degree\,,\theta(10)=0.6243degree\,,\theta(20)=1.2702degree\,
\\\psi(5)=0.3875degree\,,\psi(10)=0.7789degree\,,\psi(20)=1.5816degree\,
$$


#### 问题三与问题四模型的建立和求解

##### 问题三模型的建立与求解

已知参数空气环境速度$\vec{V}_0=(-80,0,0.2)$，由式（）可以求得：
$$
v_H=\sqrt{80^2+0.2^2}/\left((0,0,1)M_2(0,u_{eh},0)\left(\begin{array}{l}0 \\0 \\1\end{array}\right)\right)\\v_V=\sqrt{80^2+0.2^2}/\left((0,1,0)M_2(u_{av},0,0)\left(\begin{array}{l}0 \\1 \\0\end{array}\right)\right)
$$
已知三个力矩的表达式（）（）（）以及参数表达式（）~（），联立所有式子，得到力矩关于组件机动量（$u_t=0$）的关系：
$$
M_r=M_{r_1}+M_{r_2}+M_{r_4}=\frac{1}{2}C_{r_1}\rho S_1V_1^2+f(u_t)+\frac{1}{2}h_4C_{ry_4}\rho\oint_{S_4}\vec{v}^2(\vec x)\,\textrm{d}S
\\M_p=M_{p_1}+M_{p_3}=\frac{1}{2}C_{p_1}\rho S_1V_1^2+\frac{1}{2}l_3C_{p_3}\rho \oint_{S_3}\vec{v}^2(\vec x)\,\textrm{d}S
\\M_y=M_{y_1}+M_{y_4}=\frac{1}{2}C_{y_1}\rho S_1V_1^2+\frac{1}{2}l_4C_{ry_4}\rho\oint_{S_4}\vec{v}^2(\vec x)\,\textrm{d}S
$$
代入参数化简得：
$$
M_r=977.3679+1229.0242u_a-697.2349u_{c d}-\frac{0.1115+0.01899u_{a v}}{\cos ^2 u_{a v}}
$$

$$
M_p=13944.6979+1700.0714 u_e+1299.9295u_c -2.3635u_{cd}+\frac{1.2384+2.3533 u_{eh}}{\cos ^2 u_{eh}}
$$

$$
M_y=236.3508+189.0806 u_{cd}+\frac{1.6719+0.2848 u_{a v}}{\cos ^2 u_{a v}}
$$

令
$$
M_r=0
\\M_p=0
\\M_y=0
$$
只需要三个自由度，首先从线性项里选最稳定的，测试三角函数项的两个变量灵敏度，对所求方案求偏导看姿态角变化趋势即可。

##### 问题三低速模式的操作方案

在低速模式下（通常指速度低于85米/秒），姿态角的控制主要通过同轴旋翼和螺旋桨推进器实现，因此我们固定 Elevator deflection values $u_{eh}$为 $\arctan{-0.2/80}\approx-0.0025$，Rudder deflection values $u_{av}$为零，可以得到力矩关于同轴旋翼操作量的关系（$u_t=0$）：

$$
M_r=M_{r_1}+M_{r_2}+M_{r_4}=\frac{1}{2}C_{r_1}\rho S_1V_1^2+f(u_t)+\frac{1}{2}h_4C_{ry_4}\rho\oint_{S_4}\vec{v}^2(\vec x)\,\textrm{d}S
\\M_p=M_{p_1}+M_{p_3}=\frac{1}{2}C_{p_1}\rho S_1V_1^2+\frac{1}{2}l_3C_{p_3}\rho \oint_{S_3}\vec{v}^2(\vec x)\,\textrm{d}S
\\M_y=M_{y_1}+M_{y_4}=\frac{1}{2}C_{y_1}\rho S_1V_1^2+\frac{1}{2}l_4C_{ry_4}\rho\oint_{S_4}\vec{v}^2(\vec x)\,\textrm{d}S
$$
带入数值化简得：
$$
M_r=977.2564+1229.0242u_a-697.2349u_{c d}
$$

$$
M_p=13945.9304+1700.0714 u_e+1299.9295u_c -2.3635u_{cd}
$$

$$
M_y=238.0227+189.0806 u_{cd}
$$

令
$$
M_r=0
\\M_p=0
\\M_y=0
$$
可得到齐次方程组，解空间为：
$$
\left\{\begin{array}{l}
u_a=-1.5093 \\
u_{cd}=-1.2588 \\
8.2049+u_e+0.7646 u_c=0 \\
u_e \in[-25,-8.2049] \\
u_c \in[0,21.9649]
\end{array}\right.
$$

##### 问题四模型的建立与求解

在本问题中，要求直升机加速运动，这带来两方面的不同：第一，前进方向匀加速运动要求$u_t$取不为零的某定值，这会带来附加的滚转力矩$M_{r_3}$；第二，速度的增加对应着空气环境速度的增加，也即$\vec{V}_0(t)=(-5t-80,0,0,2)$，这在方程中引入时间项，使得最终结果是关于时间变化的动态值。

首先，由加速运动动力学规律可知，螺旋桨推进器提供的推力为
$$
F_p=Ma=25000N
$$
由$F_p(u_t)，M_{r_2}(u_t)$可推出相应的$M_{r_2}$。已知参数空气环境速度$\vec{V}_0=(-5t-80,0,0.2)$，由式（）可以求得：
$$
v_H=\sqrt{(80+5t)^2+0.2^2}/\left((0,0,1)M_2(0,u_{eh},0)\left(\begin{array}{l}0 \\0 \\1\end{array}\right)\right)\\v_V=\sqrt{(80+5t)^2+0.2^2}/\left((0,1,0)M_2(u_{av},0,0)\left(\begin{array}{l}0 \\1 \\0\end{array}\right)\right)
$$
已知三个力矩的表达式（）（）（）以及参数表达式（）~（），联立所有式子，得到力矩关于组件机动量的关系：
$$
M_r=M_{r_1}+M_{r_2}+M_{r_4}=\frac{1}{2}C_{r_1}\rho S_1V_1^2+f(u_t)+\frac{1}{2}h_4C_{ry_4}\rho\oint_{S_4}\vec{v}^2(\vec x)\,\textrm{d}S
\\M_p=M_{p_1}+M_{p_3}=\frac{1}{2}C_{p_1}\rho S_1V_1^2+\frac{1}{2}l_3C_{p_3}\rho \oint_{S_3}\vec{v}^2(\vec x)\,\textrm{d}S
\\M_y=M_{y_1}+M_{y_4}=\frac{1}{2}C_{y_1}\rho S_1V_1^2+\frac{1}{2}l_4C_{ry_4}\rho\oint_{S_4}\vec{v}^2(\vec x)\,\textrm{d}S
$$
带入数值化简得：
$$
M_r=12530.5443+1229.0242u_a-697.2349u_{c d}-(0.00001742+0.000002967u_{av})\frac{(80+5t)^2+0.02}{\cos ^2 u_{a v}}
$$

$$
M_p=13944.6979+1700.0714 u_e+1299.9295u_c -2.3635u_{cd}+(0.0001935+0.0003677u_{eh})\frac{(80+5t)^2+0.02}{\cos ^2 u_{eh}}
$$

$$
M_y=236.3508+189.0806 u_{cd}+(0.0002612+0.00004451u_{av})\frac{(80+5t)^2+0.02}{\cos ^2 u_{a v}}
$$

令
$$
M_r=0
\\M_p=0
\\M_y=0
$$
得到方程组（含线性项，三角函数项且含时）

##### 问题四方案的优化与确定

在加速过程中，直升机速度跨越了低速模式与高速模式。结合前述分析可知，在低速模式下姿态角控制主要...，高速模式下...（抄原文英文），因此，在80~85m/s的速度下主要操作同轴旋翼，在85~100m/s的速度下同时操纵同轴旋翼、升降舵及方向舵，在高于100...（补全）。因此，我们在三个阶段分别求解以下方程：模型测试与灵敏度分析



### 优势和劣势

#### 优势：

1. 建立了惯量主轴和局域坐标系，对角度的求解严格符合物理原理、
2. 建立了流量守恒模型以细致地考虑不同的飞机速度对动压的影响
3. 第三四问中通过灵敏度分析获得了最稳定的操作方案
4. 第四问中，在飞行速度的不同阶段考虑了不同的操作量方案

#### 劣势：

1. 前两问中忽略了飞机姿态角带来的升力和推力偏移
2. 对动压的求解和对尾翼力矩的计算不够严格
3. 没有考虑一定速度下空气相对流速带来的螺旋桨推力和扭矩的变化



### 参考文献



### 附录

